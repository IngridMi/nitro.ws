function loadButton(){Materialize.toast("Loading Configuration From Server",3e3,"rounded blue");var e=$("#api_key").val();loadDB(e,function(e,o){return e||o.error?Materialize.toast("Invalid Token",3e3,"rounded red"):(setForm(o),void Materialize.toast("Configuration Loaded",3e3,"rounded green"))})}function submitButton(){Materialize.toast("Submitting Configuration",3e3,"rounded blue");var e=$("#api_key").val(),o=collectForm();submitDB(e,o,function(e,o){return e||o.error?Materialize.toast("Invalid Token",3e3,"rounded red"):void Materialize.toast("Configuration Saved To Server",3e3,"rounded green")})}function collectForm(){var e={};A("#prefix")?e.prefix=A("#prefix"):0;var o={};o.on=B("#adblock-toggle"),o.strikes=B("#adblock-strikes"),o.notify=B("#adblock-notify"),o.ex={};var a=$("#adblock-users").material_chip("data"),t={};a.forEach(function(e){!/[^0123456789]/g.test(e.tag)&&/\d{17,}/g.test(e.tag)&&(t[e.tag]=!0)}),o.ex.users=t;var r=$("#adblock-roles").material_chip("data"),i={};r.forEach(function(e){!/[^0123456789]/g.test(e.tag)&&/\d{17,}/g.test(e.tag)&&(i[e.tag]=!0)}),o.ex.roles=i,e.adblock=o;var l={};l.strikes=B("#filter-strikes");var n=$("#filter-keywords").material_chip("data"),d={};n.forEach(function(e){d[e.tag]=!0}),l.keywords=d,e.filter=l,A("#joindm")?e.joindm=A("#joindm"):0;var c={};return c.music=!B("#module-fun"),c.social=!B("#module-fun"),c.fun=!B("#module-fun"),e.modules=c,e}function setForm(e){if(!e.prefix||$("#prefix").val(e.prefix),e.adblock){if($("#adblock-toggle").prop("checked",e.adblock.on),$("#adblock-strikes").prop("checked",e.adblock.strikes),$("#adblock-notify").prop("checked",e.adblock.notify),e.adblock.ex&&e.adblock.ex.users){var o=[];Object.keys(e.adblock.ex.users).forEach(function(e){o.push({tag:e})}),$("#adblock-users").material_chip({data:o})}if(e.adblock.ex&&e.adblock.ex.roles){var o=[];Object.keys(e.adblock.ex.roles).forEach(function(e){o.push({tag:e})}),$("#adblock-roles").material_chip({data:o})}}if(e.filter&&($("#filter-strikes").prop("checked",e.filter.strikes),e.filter.keywords)){var o=[];Object.keys(e.filter.keywords).forEach(function(e){o.push({tag:e})}),$("#filter-keywords").material_chip({data:o})}$("#joindm").val(e.joindm),$("#module-music").prop("checked",!e.modules.music),$("#module-social").prop("checked",!e.modules.social),$("#module-fun").prop("checked",!e.modules.fun)}function A(e){return 0!==$(e).val().length?$(e).val():!1}function B(e){return $(e).prop("checked")}function getOptionals(e,o){var a=window.location.href,t=new RegExp("[?&]"+e+"=([^&#]*)","i"),r=t.exec(a);return r?r[1]:null}function submitDB(e,o,a){$.ajax({url:"/database",method:"POST",headers:{Authorization:e,data:JSON.stringify(o)},dataType:"json",data:JSON.stringify(o),error:function(e,o){a(o,null)},success:function(e){a(null,e)}})}function loadDB(e,o){$.ajax({url:"/database",method:"GET",headers:{Authorization:e},dataType:"json",error:function(e,a){o(a,null)},success:function(e){o(null,e)}})}$(document).ready(function(){$("#adblock-users").material_chip({placeholder:"The ID of the user",secondaryPlaceholder:"The ID of the user"}),$("#adblock-users").on("chip.add",function(e,o){o.tag.match(/[^0123456789]/g)&&Materialize.toast("ID's are numerical only",3e3,"rounded red")}),$("#adblock-roles").material_chip({placeholder:"The ID of the role",secondaryPlaceholder:"The ID of the role"}),$("#adblock-roles").on("chip.add",function(e,o){o.tag.match(/[^0123456789]/g)&&Materialize.toast("ID's are numerical only",3e3,"rounded red")}),$("#filter-keywords").material_chip({placeholder:"The Keyword",secondaryPlaceholder:"The Keyword"}),$("#load_db").tooltip({delay:50}),$("#submit_form").tooltip({delay:50});var e=getOptionals("token");e&&($("#api_key").val(e),loadButton()),$("#load_db").click(loadButton),$("#submit_form").click(submitButton)}),function(e){e(function(){e(".button-collapse").sideNav(),e(".parallax").parallax()})}(jQuery);